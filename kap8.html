<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kapitola 5 â€“ KrystalovÃ¡ lampa</title>
  <link rel="stylesheet" href="css/style.css">
  <script defer src="js/helpers.js"></script>
</head>
<body>
  <div class="container">
  <div class="nav"><a class="btn" href="kap7c.html">â† ZpÄ›t</a></div>
    <h1>Kapitola 5 â€“ KrystalovÃ¡ lampa</h1>
    <div class="panel">
      <div class="dialogue">
        <img src="img/alchemista_vysvetlujici_smejici.png" alt="Alchymista" class="avatar">
        <div class="bubble">
          <p><strong>Alchymista:</strong> "Anoâ€¦ uÅ¾ to vidÃ­m jasnÄ›! 'ZesÃ­lenÃ¡ KoÄka' a moje 'lampa' â€“ dohromady ukÃ¡Å¾ou vÃ­c, neÅ¾ by kdy ukÃ¡zal dennÃ­ svit. Lampa je v podkrovÃ­ chaty, v truhlici."</p>
        </div>
      </div>

      <div class="choices">
        <button onclick="say(1)">â€K Äemu 'lampa' slouÅ¾Ã­?â€œ</button>
        <button onclick="say(2)">â€Z Äeho je vyrobenÃ¡?â€œ</button>
        <button onclick="say(3)">â€MÃ¡m ji!â€œ</button>
      </div>
      <div id="out" style="margin-top:10px;"></div>

      <div id="task-bubble" class="bubble" style="margin-top:10px; display:none;">
        <p><strong>Ãškol:</strong> Vypij 'ZesÃ­lenou koÄku' a jdi pod schody chaty â€“ zanechal jsem ti tam znamenÃ­ (runa ochrany) s rozsvÃ­cenou lampou ho uvidÃ­Å¡. NapiÅ¡ jmÃ©no runy abych vÄ›dÄ›li, Å¾e funguje. <em>(SprÃ¡vnÄ›: Algiz, pÅ™Ã­p. â€Zâ€œ)</em></p>
        <div class="input-row">
          <input id="runa" type="text" placeholder="JakÃ¡ je to runa?">
          <button onclick="check()">Potvrdit</button>
        </div>
        <p id="hint" class="feedback"></p>
        <div id="cont"></div>
      </div>

  <!-- Footer navigation removed -->
    </div>
  </div>

<script>
// Avatar efekt: zmÄ›na obrÃ¡zku na vydÄ›Å¡enÃ©ho na 1 sekundu + pÅ™ehrÃ¡nÃ­ zvuku
document.addEventListener('DOMContentLoaded', function() {
  var avatar = document.querySelector('.avatar');
  if(avatar) {
    var origSrc = avatar.getAttribute('src');
    var avatarAudio = document.getElementById('avatar-audio');
    if(!avatarAudio) {
      avatarAudio = document.createElement('audio');
      avatarAudio.id = 'avatar-audio';
      avatarAudio.src = 'audio/huh.ogg';
      avatarAudio.style.display = 'none';
      document.body.appendChild(avatarAudio);
    }
    avatar.addEventListener('click', function() {
      avatar.src = 'img/alchemista_vydeseny.png';
      try { avatarAudio.currentTime = 0; avatarAudio.play(); } catch(e) {}
      setTimeout(function() {
        avatar.src = origSrc;
      }, 1000);
    });
  }
});
function say(n){
  const btns = document.querySelectorAll('.choices button');
  btns.forEach((b,i)=>{
    if(i===n-1) b.classList.add('selected');
    else b.classList.remove('selected');
  });
  const o=document.getElementById('out');
  const taskBubble = document.getElementById('task-bubble');
  if(n===1){
    o.innerHTML = `<div class="bubble" style="margin-top:8px;"><p><strong>Alchymista:</strong> "Lampa odhaluje skrytÃ©. Ale pro oÄi smrtelnÃ­ku, je to bÄ›Å¾nÃ¡ lampiÄka. To pro tebe neplatÃ­."</p></div>`;
    taskBubble.style.display = 'none';
  }else if(n===2){
    o.innerHTML = `<div class="bubble" style="margin-top:8px;"><p><strong>Alchymista:</strong> "Z kÅ™iÅ¡Å¥Ã¡lu z hor. VloÅ¾il jsem do nÄ›j runu ochrany, proto svÃ­tÃ­, proto nezhasne."</p></div>`;
    taskBubble.style.display = 'none';
  }else{
    o.innerHTML = `<div class="bubble" style="margin-top:8px;"><p><strong>Alchymista:</strong> "VÃ½bornÄ›! TeÄ vypij KoÄku a pod schody hledej runu. AÅ¾ ji najdeÅ¡, napiÅ¡ mi jejÃ­ jmÃ©no."</p></div>`;
    taskBubble.style.display = 'block';
  }
}
function check(){
  const raw=document.getElementById('runa').value;
  const norm=normalizeInput(raw);
  const hint=document.getElementById('hint');
  const cont=document.getElementById('cont');
  if(norm==='algiz' || norm==='z'){
    hint.textContent='';
    cont.innerHTML = `<div class="bubble" style="margin-top:8px;"><p><strong>Alchymista:</strong> "VÃ½bornÄ›, Algiz! Ano, to je ona â€“ runa ochrany, Å¡tÃ­t proti zlu. VÄ›dÄ›l jsem, Å¾e jsi na sprÃ¡vnÃ© stopÄ›."</p></div>
    <a class="continue-btn" href="kap9.html">ğŸ‘‰ PokraÄovat </a>`;
  }else{
    hint.textContent = 'â€Neâ€¦ vypadala jako strom se zvednutÃ½mi vÄ›tvemi - Z -. Symbol ochrany. Hledej v bestiÃ¡Å™i run!â€œ';
    cont.innerHTML='';
  }
}
</script>
</body>
</html>
