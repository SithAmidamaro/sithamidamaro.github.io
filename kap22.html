<!DOCTYPE html>
<html lang="cs"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Kapitola 22 â€“ TemnÃ¡ esence</title>
<link rel="stylesheet" href="css/style.css">
<script defer src="js/helpers.js"></script>
</head><body>
<div class="container">
  <div class="nav"><a class="btn" href="kap21a.html">â† ZpÄ›t</a></div>
  <h1>Kapitola 22 â€“ TemnÃ¡ esence</h1>
  <div class="panel"><div class="dialogue">
  <img src="img/alchemista_premysli.png" alt="Alchymista" class="avatar">
  <div class="bubble"><p><strong>Alchymista:</strong> â€Jeho temnÃ¡ esence. MocnÃ¡... a velmi nebezpeÄnÃ¡. Mezi Å¾ivÃ½mi by nemÄ›la zÅ¯stat. Co s nÃ­m udÄ›lÃ¡Å¡?â€œ</p></div>
</div>
<div class="choices">
  <button onclick="pick(true)">â€SpÃ¡lÃ­m ji.â€œ</button>
  <button onclick="pick(false)">â€SchovÃ¡m si ji.â€œ</button>
</div>
<div id="out22"></div><div id="cont22"></div>
<!-- Kotva pro potvrzenÃ­ spÃ¡lenÃ­ esence -->
<div class="bubble" id="anchor22" style="margin-top:10px; display:none;">
  <p><strong>Kotva:</strong> AÅ¾ tu temnou esenci spÃ¡lÃ­Å¡ v ohni, dej mi vÄ›dÄ›t.</p>
  <div class="input-row">
    <input id="burn" type="text" placeholder="SpÃ¡leno">
    <button onclick="ok22()">Potvrdit</button>
  </div>
  <p id="hint22" class="feedback"></p>
</div>
<script>
// Avatar efekt: zmÄ›na obrÃ¡zku na mÃ¡vajÃ­cÃ­ho alchymistu na 1 sekundu + pÅ™ehrÃ¡nÃ­ zvuku hi.mp3
document.addEventListener('DOMContentLoaded', function() {
  var avatar = document.querySelector('.avatar');
  if(avatar) {
    var origSrc = avatar.getAttribute('src');
    var avatarAudio = document.getElementById('avatar-audio');
    if(!avatarAudio) {
      avatarAudio = document.createElement('audio');
      avatarAudio.id = 'avatar-audio';
      avatarAudio.src = 'audio/hi.mp3';
      avatarAudio.style.display = 'none';
      document.body.appendChild(avatarAudio);
    }
    avatar.addEventListener('click', function() {
      avatar.src = 'img/alchymista_mavajici.png';
      try { avatarAudio.currentTime = 0; avatarAudio.play(); } catch(e) {}
      setTimeout(function() {
        avatar.src = origSrc;
      }, 1000);
    });
  }
});
function pick(ok){
  const btns = document.querySelectorAll('.choices button');
  btns.forEach((b,i)=>{
    if((ok && i===0) || (!ok && i===1)) b.classList.add('selected');
    else b.classList.remove('selected');
  });
  if(ok){
    document.getElementById('out22').innerHTML = `<div class='bubble'><p><strong>Alchymista:</strong> â€SprÃ¡vnÃ¡ volba. Plamen pohltÃ­ temnotu dÅ™Ã­v, neÅ¾ by staÄila pohltit tebe. PÅ™ipravÃ­me se na oÄistnÃ½ rituÃ¡l.â€œ</p></div>`;
    // Zobraz kotvu k potvrzenÃ­
    show('anchor22');
    document.getElementById('cont22').innerHTML = '';
  }else{
    document.getElementById('out22').innerHTML = `<div class='bubble'><p><strong>Alchymista:</strong> â€To nedÄ›lej. Ta sÃ­la tÄ› zlomÃ­. OÄisti ji ohnÄ›m.â€œ</p></div>`;
    document.getElementById('cont22').innerHTML='';
    // Skryj pÅ™Ã­padnÄ› kotvu
    hide('anchor22');
  }
}
function ok22(){
  const raw = document.getElementById('burn').value || '';
  const v = normalizeInput(raw);
  if(!v){
    document.getElementById('hint22').textContent = 'Alchymista: â€StaÄÃ­ napsat â€šSpÃ¡lenoâ€˜.â€œ';
    document.getElementById('cont22').innerHTML='';
    return;
  }
  // PÅ™ijmi jakoukoli neprÃ¡zdnou odpovÄ›Ä, u jinÃ© neÅ¾ â€spÃ¡lenoâ€œ zobraz nÃ¡povÄ›du
  if(v !== 'spaleno'){
    document.getElementById('hint22').textContent = 'Alchymista: â€StaÄÃ­ napsat â€šSpÃ¡lenoâ€˜.â€œ';
  }else{
    document.getElementById('hint22').textContent = '';
  }
  document.getElementById('cont22').innerHTML = `<a class='continue-btn' href='kap22a.html'>ğŸ‘‰ PokraÄovat (Kapitola 22a)</a>`;
}
</script>
</div>
</div>
</body></html>